semantic_models:
  - name: orders
    model: ref('fct_orders')
    description: Orders fact table.

    primary_entity:
      name: order
      expr: order_id

    defaults:
      agg_time_dimension: order_date

    dimensions:
      - name: order_date
        type: time
        type_params:
          time_granularity: day
        expr: order_purchase_timestamp

      - name: order_status
        type: categorical
        expr: order_status

      - name: is_delivered
        type: categorical
        expr: is_delivered

      - name: is_on_time
        type: categorical
        expr: is_on_time

    measures:
      - name: order_count
        agg: count
        expr: order_id
        create_metric: true

      - name: revenue
        agg: sum
        expr: order_total_value
        create_metric: true

      - name: avg_order_value
        agg: average
        expr: order_total_value
        create_metric: true

      - name: avg_review_score
        agg: average
        expr: review_score
        create_metric: true

      - name: avg_delivery_days
        agg: average
        expr: delivery_time_days
        create_metric: true
